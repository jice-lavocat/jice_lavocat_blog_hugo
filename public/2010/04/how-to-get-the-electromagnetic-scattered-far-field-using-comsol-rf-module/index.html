<!DOCTYPE html>
<html lang="fr-FR">
<head>
    
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

  	<meta property="og:title" content=" How-to get the electromagnetic scattered far field using Comsol RF Module &middot;  Blog Jice Lavocat" />
  	<meta property="og:site_name" content="Blog Jice Lavocat" />
  	<meta property="og:url" content="http://localhost:1313/blog/2010/04/how-to-get-the-electromagnetic-scattered-far-field-using-comsol-rf-module/" />
    
    
  	<meta property="og:type" content="article" />

    <meta property="og:article:published_time" content="2010-04-27T00:00:00Z" />

    
    <meta property="og:article:tag" content="Comsol" />
    
    <meta property="og:article:tag" content="Electromagnetism" />
    
    <meta property="og:article:tag" content="Scattered Field" />
    
    

  <title>
     How-to get the electromagnetic scattered far field using Comsol RF Module &middot;  Blog Jice Lavocat
  </title>

    <meta name="description" content="French/English essays about our Digital World, about Nature and Mind" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="http://localhost:1313/blog/images/favicon.ico">
	  <link rel="apple-touch-icon" href="http://localhost:1313/blog/images/apple-touch-icon.png" />
    
    <link rel="stylesheet" type="text/css" href="http://localhost:1313/blog/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400|Inconsolata" />


    
      
          <link href="http://localhost:1313/blog/index.xml" rel="alternate" type="application/rss+xml" title="Blog Jice Lavocat" />
      
      
    
    <meta name="generator" content="Hugo 0.14" />

    <link rel="canonical" href="http://localhost:1313/blog/2010/04/how-to-get-the-electromagnetic-scattered-far-field-using-comsol-rf-module/" />

    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-3492655-1', 'auto');
      ga('send', 'pageview');

    </script>
    
</head>
<body class="nav-closed">

  <div class="nav">
    <h3 class="nav-title">Menu</h3>
    <a href="#" class="nav-close">
        <span class="hidden">Close</span>
    </a>
    <ul>
        
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/blog/">My Blog</a>
            </li>
        
            
            <li class="nav-opened" role="presentation">
            	<a href="/blog/about/">About me</a>
            </li>
        
    </ul>
    
    
    <a class="subscribe-button icon-feed" href="http://localhost:1313/blog/index.xml">Subscribe</a>
    
</div>
<span class="nav-cover"></span>


 <div class="site-wrapper">



<header class="main-header post-head" style="background-image: url(http://localhost:1313/blog/#ZgotmplZ)">
  <nav class="main-nav overlay clearfix">


  
      <a class="blog-logo" href="http://localhost:1313/blog/"><img src="http://localhost:1313/blog/images/logo.png" alt="Home" /></a><a class="blog-logo" href="http://localhost:1313/blog/"><div style="padding-left: 7px;text-align: left; color: #000;">Blog Jice Lavocat (Home)</div></a>
  
  
      <a class="menu-button" href="#"><span class="burger">&#9776;</span><span class="word">Menu</span></a>
  
  </nav>
</header>



<main class="content" role="main">




  <article class="post post">

    <header class="post-header">
        <h1 class="post-title">How-to get the electromagnetic scattered far field using Comsol RF Module</h1>
        <section class="post-meta">
        
          <time class="post-date" datetime="2010-04-27T00:00:00Z">
            Apr 27, 2010
          </time>
        
         
          <span class="post-tag small"><a href="http://localhost:1313/blog/tags/comsol/">#Comsol</a></span>
         
          <span class="post-tag small"><a href="http://localhost:1313/blog/tags/electromagnetism/">#Electromagnetism</a></span>
         
          <span class="post-tag small"><a href="http://localhost:1313/blog/tags/scattered-field/">#Scattered Field</a></span>
         
        </section>
    </header>
  
    <section class="post-content">
      

<p style="text-align: justify;">
  If you use Comsol Multiphysics &#8211; RF Module, you may have noticed that there is a far field option when you edit any Boundary settings. This feature will allow you to compute the <strong>scattered far field</strong> of an object using some tricks.
</p>

<h2 style="text-align: justify;">
  Initial Setting : Simple simulation using Comsol
</h2>

<p style="text-align: justify;">
  This tutorial will allow you to compute the scattered field of an ideal magnetic conducting circle in 2D. First, let&#8217;s design a square with PML around to absorb the outgoing light. Create a problem using <strong>Plane TM waves</strong> (we will change this latter to scattered TM waves, but the tutorial was made for an initial TM problem, and not for Scattered TM). We will assume you know how to use Comsol as a beginner user, so you know how to design the following structure :
</p>

<ul>
<li>a square centered in (0,0), of length 0.2</li>
<li>4 additional rectangular borders to this square, of thickness 0.02</li>
<li>a centered circle of radius 0.01</li>
<li>a centered circle of radius 0.8</li>
</ul>

<p> </p>

<p> </p>

<p> </p>

<div id="attachment_1053" style="width: 310px" class="wp-caption aligncenter">
  <a href="images/posts/oldwordpress/uploads/2010/04/setting_base.png"><figure class="size-medium wp-image-1053">

    <img src="http://localhost:1313/blog//images/posts/oldwordpress/uploads/2010/04/setting_base-300x220.png" width="300" />
    

<figcaption>
    <h4>setting_base</h4>
    
</figcaption>

</figure></a>
  
  <p class="wp-caption-text">
    Basic Setting
  </p>
</div>

<p style="text-align: justify;">
   
</p>

<p style="text-align: justify;">
  Now you should modify the design a little bit in terms of properties. First, select the big circle, and transform it to a curve (&#8220;Coerce to curve&#8221;). You should also remove the small circle from the main substrate to latter change its properties. In order to do that, select the small circle and the main square, and click on &#8220;difference&#8221;. Then, add some cartesian PML to the 4 rectangles : <strong>Physics </strong>> <strong>Subdomain settings</strong> > <em>select the areas</em> > <strong>PML</strong> ><strong><em> </em>Cartesian</strong> <em>>  Try to figure out which PML you need to inser</em> (left/righ absorb along <strong>x</strong>, top and bottom along <strong>y</strong>, corners along <strong>x</strong> and <strong>y</strong> directions)).
</p>

<p style="text-align: justify;">
  The following image shows the resulting construction. In order to highlight the construction I changed my <strong>Options </strong>> <strong>Preferences </strong>> <strong>Visualization</strong>, and checked the &#8220;Render Face&#8221; button.
</p>

<p> </p>

<p> </p>

<p> </p>

<p> </p>

<div id="attachment_1055" style="width: 310px" class="wp-caption aligncenter">
  <a href="images/posts/oldwordpress/uploads/2010/04/Setting_normal.png"><figure class="size-medium wp-image-1055">

    <img src="http://localhost:1313/blog//images/posts/oldwordpress/uploads/2010/04/Setting_normal-300x220.png" width="300" />
    

<figcaption>
    <h4>Setting_normal</h4>
    
</figcaption>

</figure></a>
  
  <p class="wp-caption-text">
    Normal Setting
  </p>
</div>

<p> </p>

<h2 id="collecting-the-far-field:4c4056b789433fda8d2903371113b53f">Collecting the Far-Field</h2>

<p style="text-align: justify;">
  In order to collect the far field using Comsol Multiphysics, you need to change some &#8220;Physics&#8221; values. First, let&#8217;s explain what will be our simulation case. A plane wave will come from the inner-left boundary of the small square. We will use TM waves, with Hz=1 A (magnetic field) emerging from this inner boundary. So the source is located on <strong>x=-0.1</strong>. We thus need to indicate this to comsol. Go to <strong>Physics </strong>> <strong>Scalar variables</strong> > <em>Change the value of </em><strong>H0iz_rfwh</strong><em> to</em> <strong>exp(-j*k0_rfwh*(x+0.1)).</strong>
</p>

<p style="text-align: justify;">
  Now we need to indicate Comsol that we want to integrate the far field on the big circle we draw during the first step. Modify the <strong>Boundary settings</strong> to add a far fiel value, called <strong>Efar</strong> on the curves representing the circle.
</p>

<p style="text-align: justify;">
   
</p>

<p> </p>

<p> </p>

<div id="attachment_1057" style="width: 310px" class="wp-caption aligncenter">
  <a href="images/posts/oldwordpress/uploads/2010/04/Efar.png"><figure class="size-medium wp-image-1057">

    <img src="http://localhost:1313/blog//images/posts/oldwordpress/uploads/2010/04/Efar-300x220.png" width="300" />
    

<figcaption>
    <h4>Efar</h4>
    
</figcaption>

</figure></a>
  
  <p class="wp-caption-text">
    Efar is defined on the big circle
  </p>
</div>

<p style="text-align: justify;">
  Note that you just need to write the name of the variable <strong>Efar</strong>, and comsol will automatically create resulting variables.
</p>

<p style="text-align: justify;">
  Next you need to inser a relation to get <strong>Hfar</strong> from <strong>Efar. </strong>Indeed, we are looking at the magnetic field, Hz, and not at Ez. Go to <strong>Options</strong> > <strong>Expressions > Global Expressions.</strong> Add the following expressions :
</p>

<ul>
<li>r : sqrt(x^2+y^2)</li>
<li>Hfar : (x/r*Efary-y/r*Efarx)*sqrt(epsilon0_rfwh/mu0_rfwh)</li>
</ul>

<p>Now you are almost done. To get a better scattered result, you need to change the way comsol solve the problem. go to <strong>Physics &gt; Properties &gt;</strong> change <strong>Field type</strong> to <strong>Scattered TM.</strong></p>

<p>You can finally start the solving process.</p>

<h2 id="visualizing-the-scattered-far-field:4c4056b789433fda8d2903371113b53f">Visualizing the scattered far-field</h2>

<p style="text-align: justify;">
  You can now visualize the scattered field in the <strong>Plot paramaters</strong> > <strong>Surface </strong>section (Scattered Magnetic Field, z component). Nevertheless, the great feature is that you can now plot an angular far field plot using matlab.
</p>

<p style="text-align: justify;">
  First, in Comsol, <strong>Postprocessing</strong> > <strong>Domain Plot Parameters</strong> > <strong>Line/ Extrusion</strong> > <em>select the big circle&#8217;s curves</em>. In the <strong>y-axis data</strong>, change the expression to <strong>abs(Hfar)</strong>. In the <strong>x-axis data</strong>, select &#8220;<strong>Expression&#8221; </strong>and inser the following expression &#8220;<strong>atan2(y,x)</strong>&#8220;. It is used to display the data along the circle, using an angular representation. Clik <strong>Ok</strong>, you should get something similar to the following.
</p>

<p> </p>

<p> </p>

<div id="attachment_1061" style="width: 310px" class="wp-caption aligncenter">
  <a href="images/posts/oldwordpress/uploads/2010/04/Hfar_Comsol1.png"><figure class="size-medium wp-image-1062">

    <img src="http://localhost:1313/blog//images/posts/oldwordpress/uploads/2010/04/Hfar_Comsol1-300x261.png" width="300" />
    

<figcaption>
    <h4>Hfar_Comsol</h4>
    
</figcaption>

</figure></a>
  
  <p class="wp-caption-text">
    Hfar using comsol
  </p>
</div>

<p style="text-align: justify;">
  In order to visualize this with Matlab, click on th <strong>ASCII</strong> button, and save the plot data on your computer. Let&#8217;s call it <em>scat_circ.txt</em>. Open Matlab. Import this data : <strong>File > Import Data > </strong><em>select scat_circ.txt (then </em><strong>Next </strong><em>, then </em><strong>Finish</strong><em>).</em>
</p>

<p style="text-align: justify;">
  Now, just use the following command lines :<em> </em>
</p>

<ul>
<li>scat_data=sortrows(scatt_circ);</li>
<li>rho=scat_data(:,2);</li>
<li>theta=scat_data(:,1);</li>
<li>polar(theta,abs(rho))</li>
</ul>

<p>You should get the resulting :</p>

<p style="text-align: justify;">
  <em>
  
  <div id="attachment_1064" style="width: 310px" class="wp-caption aligncenter">
    <em><a href="images/posts/oldwordpress/uploads/2010/04/Hafr_Matlab.png"><figure class="size-medium wp-image-1064">

    <img src="http://localhost:1313/blog//images/posts/oldwordpress/uploads/2010/04/Hafr_Matlab-300x219.png" width="300" />
    

<figcaption>
    <h4>Hafr_Matlab</h4>
    
</figcaption>

</figure></a></em>
    
    <p class="wp-caption-text">
      Hfar of a scattering circle using Matlab
    </p>
  </div></em>
</p>

<p style="text-align: justify;">
   
</p>

<p style="text-align: justify;">
  <em>To follow</em> : You can also compared the resulting field with a theoretical diffracted circle. In the following article, I will explain how to compute the scattered field of a circle theoretically.
</p>

    </section>


  <footer class="post-footer">


    
    <figure class="author-image">
        <a class="img" href="http://localhost:1313/blog/" style="background-image: url(http://localhost:1313/blog/images/logo.png)"><span class="hidden">Jean-Christophe Lavocat's Picture</span></a>
    </figure>
    

    





<section class="author">
  <h4><a href="http://localhost:1313/blog/">Jean-Christophe Lavocat</a></h4>
  
  <p>World citizen, often found in France, loving Nature, Music and Startups</p>
  
  <div class="author-meta">
    <span class="author-location icon-location">Toulon, France</span>
    <span class="author-link icon-link"><a href="http://jice.lavocat.name">http://jice.lavocat.name</a></span>
  </div>
</section>



    
    <section class="share">
      <h4>Share this post</h4>
      <a class="icon-twitter" style="font-size: 1.4em" href="https://twitter.com/share?text=How-to%20get%20the%20electromagnetic%20scattered%20far%20field%20using%20Comsol%20RF%20Module&amp;url=http%3a%2f%2flocalhost%3a1313%2fblog%2f2010%2f04%2fhow-to-get-the-electromagnetic-scattered-far-field-using-comsol-rf-module%2f"
          onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
          <span class="hidden">Twitter</span>
      </a>
      <a class="icon-facebook" style="font-size: 1.4em" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2flocalhost%3a1313%2fblog%2f2010%2f04%2fhow-to-get-the-electromagnetic-scattered-far-field-using-comsol-rf-module%2f"
          onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
          <span class="hidden">Facebook</span>
      </a>
      <a class="icon-google-plus" style="font-size: 1.4em" href="https://plus.google.com/share?url=http%3a%2f%2flocalhost%3a1313%2fblog%2f2010%2f04%2fhow-to-get-the-electromagnetic-scattered-far-field-using-comsol-rf-module%2f"
         onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
          <span class="hidden">Google+</span>
      </a>
    </section>
    

    
    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_shortname = 'jicelavocat';
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    
    

  </footer>
</article>

</main>
    <footer class="site-footer clearfix">
        <section class="copyright"><a href="">Blog Jice Lavocat</a> All rights reserved - 2015</section>
        
        <section class="poweredby">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/vjeantet/hugo-theme-casper">Casper</a> theme</section>
        
    </footer>
    </div>
    <script type="text/javascript" src="http://localhost:1313/blog/js/jquery.js"></script>
    <script type="text/javascript" src="http://localhost:1313/blog/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="http://localhost:1313/blog/js/index.js"></script>

<script data-no-instant>document.write('<script src="http://'
        + (location.host || 'localhost').split(':')[0]
		+ ':1313/livereload.js?mindelay=10"></'
        + 'script>')</script></body>
</html>

